{"ast":null,"code":"var _jsxFileName = \"G:\\\\Yevhen\\\\GoIT\\\\react_hw\\\\tech_part\\\\src\\\\components\\\\FollowButton\\\\FollowButton.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { StyledButton } from \"./FollowButton.styled\";\nimport { addFollower } from \"../../api/fetchUser\";\nimport localStorageCustom from \"../../utils/storage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FollowButton = _ref => {\n  _s();\n  let {\n    userId,\n    followers,\n    cards\n  } = _ref;\n  const [follow, setFollow] = useState(false);\n  useEffect(() => {\n    localStorageCustom.save(\"tweets\", cards);\n    const updateTweets = localStorageCustom.load(\"tweets\").map(user => {\n      if (!user.hasOwnProperty(\"isFollowing\")) {\n        return {\n          ...user,\n          isFollowing: false\n        };\n      }\n      return user;\n    });\n    localStorageCustom.save(\"tweets\", updateTweets);\n    const user = updateTweets.find(card => card.id === userId);\n    const isFollowing = user && user.isFollowing;\n    setFollow(isFollowing);\n  }, [cards, userId]);\n  const findFollowingUserIndex = () => {\n    const userIndex = localStorageCustom.load(\"tweets\").findIndex(index => {\n      return index.id.includes(userId);\n    });\n    return userIndex;\n  };\n  const handleChangeFollow = () => {\n    const userIndex = findFollowingUserIndex();\n    const tweetsStorage = localStorageCustom.load(\"tweets\");\n    if (!follow) {\n      setFollow(true);\n      tweetsStorage[userIndex].isFollowing = true;\n      addFollower(userId, +followers + 1);\n    } else if (follow) {\n      tweetsStorage[userIndex].isFollowing = false;\n      setFollow(false);\n      addFollower(userId, followers);\n    }\n    localStorageCustom.save(\"tweets\", tweetsStorage);\n  };\n  return /*#__PURE__*/_jsxDEV(StyledButton, {\n    follow: follow,\n    onClick: () => handleChangeFollow(),\n    children: follow ? \"following\" : \"follow\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n};\n_s(FollowButton, \"m7239ROchsMZnHxbr47kKJgMoSM=\");\n_c = FollowButton;\nexport default FollowButton;\nvar _c;\n$RefreshReg$(_c, \"FollowButton\");","map":{"version":3,"names":["useEffect","useState","StyledButton","addFollower","localStorageCustom","jsxDEV","_jsxDEV","FollowButton","_ref","_s","userId","followers","cards","follow","setFollow","save","updateTweets","load","map","user","hasOwnProperty","isFollowing","find","card","id","findFollowingUserIndex","userIndex","findIndex","index","includes","handleChangeFollow","tweetsStorage","onClick","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["G:/Yevhen/GoIT/react_hw/tech_part/src/components/FollowButton/FollowButton.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { StyledButton } from \"./FollowButton.styled\";\r\nimport { addFollower } from \"../../api/fetchUser\";\r\nimport localStorageCustom from \"../../utils/storage\";\r\n\r\nconst FollowButton = ({ userId, followers, cards }) => {\r\n  const [follow, setFollow] = useState(false);\r\n\r\n  useEffect(() => {\r\n    localStorageCustom.save(\"tweets\", cards);\r\n    const updateTweets = localStorageCustom.load(\"tweets\").map((user) => {\r\n      if (!user.hasOwnProperty(\"isFollowing\")) {\r\n        return { ...user, isFollowing: false };\r\n      }\r\n      return user;\r\n    });\r\n    localStorageCustom.save(\"tweets\", updateTweets);\r\n\r\n    const user = updateTweets.find((card) => card.id === userId);\r\n    const isFollowing = user && user.isFollowing;\r\n    setFollow(isFollowing);\r\n  }, [cards, userId]);\r\n\r\n  const findFollowingUserIndex = () => {\r\n    const userIndex = localStorageCustom.load(\"tweets\").findIndex((index) => {\r\n      return index.id.includes(userId);\r\n    });\r\n    return userIndex;\r\n  };\r\n\r\n  const handleChangeFollow = () => {\r\n    const userIndex = findFollowingUserIndex();\r\n    const tweetsStorage = localStorageCustom.load(\"tweets\");\r\n\r\n    if (!follow) {\r\n      setFollow(true);\r\n      tweetsStorage[userIndex].isFollowing = true;\r\n      addFollower(userId, +followers + 1);\r\n    } else if (follow) {\r\n      tweetsStorage[userIndex].isFollowing = false;\r\n      setFollow(false);\r\n      addFollower(userId, followers);\r\n    }\r\n    localStorageCustom.save(\"tweets\", tweetsStorage);\r\n  };\r\n\r\n  return (\r\n    <StyledButton follow={follow} onClick={() => handleChangeFollow()}>\r\n      {follow ? \"following\" : \"follow\"}\r\n    </StyledButton>\r\n  );\r\n};\r\n\r\nexport default FollowButton;\r\n"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,YAAY,QAAQ,uBAAuB;AACpD,SAASC,WAAW,QAAQ,qBAAqB;AACjD,OAAOC,kBAAkB,MAAM,qBAAqB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAErD,MAAMC,YAAY,GAAGC,IAAA,IAAkC;EAAAC,EAAA;EAAA,IAAjC;IAAEC,MAAM;IAAEC,SAAS;IAAEC;EAAM,CAAC,GAAAJ,IAAA;EAChD,MAAM,CAACK,MAAM,EAAEC,SAAS,CAAC,GAAGb,QAAQ,CAAC,KAAK,CAAC;EAE3CD,SAAS,CAAC,MAAM;IACdI,kBAAkB,CAACW,IAAI,CAAC,QAAQ,EAAEH,KAAK,CAAC;IACxC,MAAMI,YAAY,GAAGZ,kBAAkB,CAACa,IAAI,CAAC,QAAQ,CAAC,CAACC,GAAG,CAAEC,IAAI,IAAK;MACnE,IAAI,CAACA,IAAI,CAACC,cAAc,CAAC,aAAa,CAAC,EAAE;QACvC,OAAO;UAAE,GAAGD,IAAI;UAAEE,WAAW,EAAE;QAAM,CAAC;MACxC;MACA,OAAOF,IAAI;IACb,CAAC,CAAC;IACFf,kBAAkB,CAACW,IAAI,CAAC,QAAQ,EAAEC,YAAY,CAAC;IAE/C,MAAMG,IAAI,GAAGH,YAAY,CAACM,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACC,EAAE,KAAKd,MAAM,CAAC;IAC5D,MAAMW,WAAW,GAAGF,IAAI,IAAIA,IAAI,CAACE,WAAW;IAC5CP,SAAS,CAACO,WAAW,CAAC;EACxB,CAAC,EAAE,CAACT,KAAK,EAAEF,MAAM,CAAC,CAAC;EAEnB,MAAMe,sBAAsB,GAAGA,CAAA,KAAM;IACnC,MAAMC,SAAS,GAAGtB,kBAAkB,CAACa,IAAI,CAAC,QAAQ,CAAC,CAACU,SAAS,CAAEC,KAAK,IAAK;MACvE,OAAOA,KAAK,CAACJ,EAAE,CAACK,QAAQ,CAACnB,MAAM,CAAC;IAClC,CAAC,CAAC;IACF,OAAOgB,SAAS;EAClB,CAAC;EAED,MAAMI,kBAAkB,GAAGA,CAAA,KAAM;IAC/B,MAAMJ,SAAS,GAAGD,sBAAsB,CAAC,CAAC;IAC1C,MAAMM,aAAa,GAAG3B,kBAAkB,CAACa,IAAI,CAAC,QAAQ,CAAC;IAEvD,IAAI,CAACJ,MAAM,EAAE;MACXC,SAAS,CAAC,IAAI,CAAC;MACfiB,aAAa,CAACL,SAAS,CAAC,CAACL,WAAW,GAAG,IAAI;MAC3ClB,WAAW,CAACO,MAAM,EAAE,CAACC,SAAS,GAAG,CAAC,CAAC;IACrC,CAAC,MAAM,IAAIE,MAAM,EAAE;MACjBkB,aAAa,CAACL,SAAS,CAAC,CAACL,WAAW,GAAG,KAAK;MAC5CP,SAAS,CAAC,KAAK,CAAC;MAChBX,WAAW,CAACO,MAAM,EAAEC,SAAS,CAAC;IAChC;IACAP,kBAAkB,CAACW,IAAI,CAAC,QAAQ,EAAEgB,aAAa,CAAC;EAClD,CAAC;EAED,oBACEzB,OAAA,CAACJ,YAAY;IAACW,MAAM,EAAEA,MAAO;IAACmB,OAAO,EAAEA,CAAA,KAAMF,kBAAkB,CAAC,CAAE;IAAAG,QAAA,EAC/DpB,MAAM,GAAG,WAAW,GAAG;EAAQ;IAAAqB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACpB,CAAC;AAEnB,CAAC;AAAC5B,EAAA,CA9CIF,YAAY;AAAA+B,EAAA,GAAZ/B,YAAY;AAgDlB,eAAeA,YAAY;AAAC,IAAA+B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}