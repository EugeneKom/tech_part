{"ast":null,"code":"import _objectSpread from\"G:/Yevhen/GoIT/react_hw/tech_part/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"G:/Yevhen/GoIT/react_hw/tech_part/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{StyledButton}from\"./FollowButton.styled\";import{addFollower}from\"../../api/fetchUser\";import localStorageCustom from\"../../utils/storage\";import{jsx as _jsx}from\"react/jsx-runtime\";var FollowButton=function FollowButton(_ref){var userId=_ref.userId,followers=_ref.followers,cards=_ref.cards;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),follow=_useState2[0],setFollow=_useState2[1];useEffect(function(){localStorageCustom.save(\"tweets\",cards);var updateTweets=localStorageCustom.load(\"tweets\").map(function(user){if(!user.hasOwnProperty(\"isFollowing\")){return _objectSpread(_objectSpread({},user),{},{isFollowing:false});}return user;});localStorageCustom.save(\"tweets\",updateTweets);var user=updateTweets.find(function(card){return card.id===userId;});var isFollowing=user&&user.isFollowing;setFollow(isFollowing);},[cards,userId]);var findFollowingUserIndex=function findFollowingUserIndex(){var userIndex=localStorageCustom.load(\"tweets\").findIndex(function(index){return index.id.includes(userId);});return userIndex;};var handleChangeFollow=function handleChangeFollow(){var userIndex=findFollowingUserIndex();var tweetsStorage=localStorageCustom.load(\"tweets\");if(!follow){setFollow(true);tweetsStorage[userIndex].isFollowing=true;addFollower(userId,+followers+1);}else if(follow){tweetsStorage[userIndex].isFollowing=false;setFollow(false);addFollower(userId,followers);}localStorageCustom.save(\"tweets\",tweetsStorage);};return/*#__PURE__*/_jsx(StyledButton,{follow:follow,onClick:function onClick(){return handleChangeFollow();},children:follow?\"following\":\"follow\"});};export default FollowButton;","map":{"version":3,"names":["useEffect","useState","StyledButton","addFollower","localStorageCustom","jsx","_jsx","FollowButton","_ref","userId","followers","cards","_useState","_useState2","_slicedToArray","follow","setFollow","save","updateTweets","load","map","user","hasOwnProperty","_objectSpread","isFollowing","find","card","id","findFollowingUserIndex","userIndex","findIndex","index","includes","handleChangeFollow","tweetsStorage","onClick","children"],"sources":["G:/Yevhen/GoIT/react_hw/tech_part/src/components/FollowButton/FollowButton.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { StyledButton } from \"./FollowButton.styled\";\r\nimport { addFollower } from \"../../api/fetchUser\";\r\nimport localStorageCustom from \"../../utils/storage\";\r\n\r\nconst FollowButton = ({ userId, followers, cards }) => {\r\n  const [follow, setFollow] = useState(false);\r\n\r\n  useEffect(() => {\r\n    localStorageCustom.save(\"tweets\", cards);\r\n    const updateTweets = localStorageCustom.load(\"tweets\").map((user) => {\r\n      if (!user.hasOwnProperty(\"isFollowing\")) {\r\n        return { ...user, isFollowing: false };\r\n      }\r\n      return user;\r\n    });\r\n    localStorageCustom.save(\"tweets\", updateTweets);\r\n\r\n    const user = updateTweets.find((card) => card.id === userId);\r\n    const isFollowing = user && user.isFollowing;\r\n    setFollow(isFollowing);\r\n  }, [cards, userId]);\r\n\r\n  const findFollowingUserIndex = () => {\r\n    const userIndex = localStorageCustom.load(\"tweets\").findIndex((index) => {\r\n      return index.id.includes(userId);\r\n    });\r\n    return userIndex;\r\n  };\r\n\r\n  const handleChangeFollow = () => {\r\n    const userIndex = findFollowingUserIndex();\r\n    const tweetsStorage = localStorageCustom.load(\"tweets\");\r\n\r\n    if (!follow) {\r\n      setFollow(true);\r\n      tweetsStorage[userIndex].isFollowing = true;\r\n      addFollower(userId, +followers + 1);\r\n    } else if (follow) {\r\n      tweetsStorage[userIndex].isFollowing = false;\r\n      setFollow(false);\r\n      addFollower(userId, followers);\r\n    }\r\n    localStorageCustom.save(\"tweets\", tweetsStorage);\r\n  };\r\n\r\n  return (\r\n    <StyledButton follow={follow} onClick={() => handleChangeFollow()}>\r\n      {follow ? \"following\" : \"follow\"}\r\n    </StyledButton>\r\n  );\r\n};\r\n\r\nexport default FollowButton;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}